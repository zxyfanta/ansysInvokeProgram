# 激光毁伤仿真系统环境配置指南

## 📋 环境信息

### 系统环境
- **操作系统**: macOS (也支持Linux和Windows)
- **Python版本**: 3.9.6 (推荐3.8+)
- **包管理器**: pip (不使用conda)
- **GUI框架**: PyQt5
- **虚拟环境**: venv

### 项目路径
- **项目根目录**: `/Users/zoujian/ai_completion/jghs/`
- **虚拟环境**: `./laser_simulation_env/`
- **源代码**: `./src/laser_damage/`
- **启动脚本**: `./run_gui.py`

## 🚀 环境创建命令

### 1. 创建虚拟环境
```bash
# 进入项目目录
cd /path/to/your/project

# 创建Python虚拟环境
python3 -m venv laser_simulation_env

# 激活虚拟环境 (macOS/Linux)
source laser_simulation_env/bin/activate

# 激活虚拟环境 (Windows)
# laser_simulation_env\Scripts\activate
```

### 2. 升级pip并安装依赖
```bash
# 确保虚拟环境已激活
source laser_simulation_env/bin/activate

# 升级pip到最新版本
pip install --upgrade pip

# 安装项目依赖
pip install -r requirements.txt
```

### 3. 验证安装
```bash
# 运行GUI测试
python test_gui.py

# 或直接启动GUI
python run_gui.py

# 检查运行状态
python simple_check.py
```

## 📦 核心依赖包

### GUI和可视化
```
PyQt5==5.15.9
matplotlib==3.7.1
numpy==1.24.3
pandas==2.0.2
```

### 科学计算和可视化
```
scipy==1.10.1
pyvista==0.40.1
vtk==9.2.6
scikit-learn==1.2.2
```

### 数据处理
```
h5py==3.8.0
netCDF4==1.6.4
openpyxl==3.1.2
xlsxwriter==3.1.2
```

### 报告生成
```
reportlab==4.0.4
jinja2==3.1.2
weasyprint==59.0
```

### 开发和测试
```
pytest==7.3.1
black==23.3.0
flake8==6.0.0
mypy==1.3.0
```

### 工具库
```
click==8.1.3
tqdm==4.65.0
pyyaml==6.0
loguru==0.7.0
psutil==5.9.5
```

## 🔧 环境管理命令

### 激活/停用环境
```bash
# 激活虚拟环境
source laser_simulation_env/bin/activate

# 停用虚拟环境
deactivate
```

### 包管理
```bash
# 查看已安装的包
pip list

# 查看包信息
pip show package_name

# 更新包
pip install --upgrade package_name

# 导出当前环境
pip freeze > requirements_current.txt
```

### 环境重建
```bash
# 删除现有环境
rm -rf laser_simulation_env

# 重新创建环境
python3 -m venv laser_simulation_env
source laser_simulation_env/bin/activate
pip install --upgrade pip
pip install -r requirements.txt
```

## 🖥️ 跨平台支持

### Windows环境
```cmd
# 创建虚拟环境
python -m venv laser_simulation_env

# 激活环境
laser_simulation_env\Scripts\activate

# 安装依赖
pip install -r requirements.txt

# 启动GUI
python run_gui.py
```

### Linux环境
```bash
# 安装系统依赖 (Ubuntu/Debian)
sudo apt-get update
sudo apt-get install python3-venv python3-dev python3-tk

# 创建虚拟环境
python3 -m venv laser_simulation_env
source laser_simulation_env/bin/activate

# 安装依赖
pip install -r requirements.txt

# 启动GUI
python run_gui.py
```

## ⚠️ 常见问题和解决方案

### 1. PyQt5安装失败
```bash
# macOS
brew install pyqt5

# Ubuntu/Debian
sudo apt-get install python3-pyqt5

# 然后重新安装
pip install PyQt5
```

### 2. matplotlib中文字体问题
```python
# 在代码中设置字体
import matplotlib.pyplot as plt
plt.rcParams['font.sans-serif'] = ['Arial Unicode MS', 'SimHei', 'DejaVu Sans']
plt.rcParams['axes.unicode_minus'] = False
```

### 3. 虚拟环境路径问题
```bash
# 确保在项目根目录创建虚拟环境
pwd  # 检查当前目录
ls   # 确认项目文件存在
```

### 4. 权限问题 (Linux/macOS)
```bash
# 给脚本执行权限
chmod +x run_gui.py
chmod +x test_gui.py
```

## 📝 开发环境配置

### IDE配置 (VS Code)
```json
{
    "python.defaultInterpreterPath": "./laser_simulation_env/bin/python",
    "python.terminal.activateEnvironment": true,
    "python.linting.enabled": true,
    "python.linting.flake8Enabled": true,
    "python.formatting.provider": "black"
}
```

### 环境变量设置
```bash
# 添加到 ~/.bashrc 或 ~/.zshrc
export LASER_SIM_HOME="/path/to/project"
export PYTHONPATH="$LASER_SIM_HOME/src:$PYTHONPATH"

# 创建别名
alias laser-gui="cd $LASER_SIM_HOME && source laser_simulation_env/bin/activate && python run_gui.py"
alias laser-test="cd $LASER_SIM_HOME && source laser_simulation_env/bin/activate && python test_gui.py"
```

## 🔄 环境更新流程

### 添加新依赖
```bash
# 激活环境
source laser_simulation_env/bin/activate

# 安装新包
pip install new_package

# 更新requirements.txt
pip freeze > requirements.txt

# 提交更改
git add requirements.txt
git commit -m "Add new dependency: new_package"
```

### 环境同步
```bash
# 其他开发者同步环境
git pull
source laser_simulation_env/bin/activate
pip install -r requirements.txt
```

## 📊 环境状态检查

### 快速检查脚本
```bash
# 检查Python版本
python --version

# 检查虚拟环境
which python

# 检查关键包
python -c "import PyQt5; print('PyQt5 OK')"
python -c "import matplotlib; print('matplotlib OK')"
python -c "import numpy; print('numpy OK')"

# 运行完整检查
python simple_check.py
```

---

**创建时间**: 2024-01-01  
**适用系统**: macOS, Linux, Windows  
**Python版本**: 3.8+  
**维护状态**: 活跃维护
